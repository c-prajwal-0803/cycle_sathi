<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Cycleâ€¯Sathiâ€¯Web</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">
<style>
  body{font-family:'Poppins',sans-serif;background:linear-gradient(135deg,#ffe6f0 0%,#f7ecff 100%);min-height:100vh;color:#333;}
  .screen{display:none;} .active{display:block;}
  h2,h3,h5{color:#630A60;}
  .card-box{background:#fff;border-radius:15px;box-shadow:0 4px 12px rgba(0,0,0,0.1);padding:30px;margin:20px auto;}
  .btn-primary{background-color:#e75480;border:none;} .btn-primary:hover{background-color:#d44672;}
  .btn-success{background:#8ac926;border:none;} .btn-success:hover{background:#75b61e;}
  .navbar{background:linear-gradient(90deg,#e75480,#bc6ff1);}
  .navbar-brand{font-weight:600;letter-spacing:0.5px;}
  .navbar .nav-link{color:white!important;font-weight:500;padding:8px 16px;}
  .navbar .nav-link:hover{background:rgba(255,255,255,0.2);border-radius:5px;}
  label{font-weight:500;}
  input[type="date"],.form-control,.form-select,textarea{border-radius:10px;border:1px solid #ddd;}
  #screen1{text-align:center;padding-top:10vh;}
  #screen1 img{width:180px;border-radius:50%;border:4px solid #fff;box-shadow:0 4px 8px rgba(0,0,0,0.1);}
  .section{display:none;} .active-section{display:block;}
  #records table th,#records table td{vertical-align:top;font-size:0.9rem;}
  #records table thead th{color:#630A60;font-weight:600;}
  #learn input,#learn textarea{background:#fff8fb;}
  #listenBtn{background-color:#bc6ff1;color:#fff;border:none;}#listenBtn:hover{background-color:#a655db;}
</style>
</head>
<body>

<!-- ===== SPLASH ===== -->
<div id="screen1" class="screen active text-center">
  <img src="https://via.placeholder.com/180/ffe6f0/630A60?text=Cycle+Sathi" alt="logo" class="mb-4">
  <h2>Cycleâ€¯Sathi</h2>
  <p class="text-muted">Understand, track, and care for your cycle!</p>
  <button class="btn btn-primary mt-3 px-4 py-2" onclick="showScreen('screen2')">Getâ€¯Started</button>
</div>

<!-- ===== LOGIN ===== -->
<div id="screen2" class="screen container py-5">
  <div class="card-box col-md-6">
    <h3 class="text-center mb-4">Login</h3>
    <div class="mb-3"><label>Emailâ€¯/â€¯Username</label><input id="loginEmail" class="form-control"></div>
    <div class="mb-3"><label>Password</label><input id="loginPass" type="password" class="form-control"></div>
    <button class="btn btn-success w-100 mt-2" onclick="loginUser()">Login</button>
    <p class="mt-3 text-center">Newâ€¯user?â€¯<a href="#" onclick="showScreen('screen4')">Signâ€¯Up</a></p>
  </div>
</div>

<!-- ===== SIGNUP ===== -->
<div id="screen4" class="screen container py-5">
  <div class="card-box col-md-6">
    <h3 class="text-center mb-4">Createâ€¯Account</h3>
    <div class="mb-3"><label>Emailâ€¯/â€¯Username</label><input id="signEmail" class="form-control"></div>
    <div class="mb-3"><label>Password</label><input id="signPass" type="password" class="form-control"></div>
    <div class="mb-3"><label>Confirmâ€¯Password</label><input id="signConf" type="password" class="form-control"></div>
    <button class="btn btn-primary w-100" onclick="registerUser()">Signâ€¯Up</button>
    <button class="btn btn-link w-100 mt-2" onclick="showScreen('screen2')">Backâ€¯toâ€¯Login</button>
  </div>
</div>

<!-- ===== HOME ===== -->
<div id="home" class="screen">
<nav class="navbar navbar-expand-lg navbar-dark">
  <div class="container">
    <a class="navbar-brand">ðŸŒ¸â€¯Cycleâ€¯Sathi</a>
    <div class="navbar-nav ms-auto">
      <a class="nav-link" href="#" onclick="showSection('profile')">Profile</a>
      <a class="nav-link" href="#" onclick="showSection('track')">Track</a>
      <a class="nav-link" href="#" onclick="showSection('learn')">Learn</a>
      <a class="nav-link" href="#" onclick="showSection('records')">Records</a>
      <a class="nav-link" href="#" onclick="logout()">Logout</a>
    </div>
  </div>
</nav>

<div class="container py-4">

<!-- ==== PROFILE ==== -->
<section id="profile" class="section active-section">
  <div class="card-box">
    <h3>Profile</h3><hr>
    <div class="row g-3">
      <div class="col-md-6"><label>Name</label><input id="name" class="form-control"></div>
      <div class="col-md-3"><label>Age</label><input id="age" type="number" class="form-control"></div>
      <div class="col-md-3">
        <label>Gender</label>
        <select id="gender" class="form-select">
          <option value="">Selectâ€¯Gender</option>
          <option value="Female">Female</option>
          <option value="Male">Male</option>
          <option value="Other">Other</option>
          <option value="Prefer not to say">Preferâ€¯notâ€¯toâ€¯say</option>
        </select>
      </div>
      <div class="col-md-3"><label>Cycleâ€¯Lengthâ€¯(days)</label><input id="cycleLen" type="number" class="form-control"></div>
      <div class="col-md-6"><label>Allergies</label><input id="allergies" class="form-control"></div>
      <div class="col-md-6"><label>Medicalâ€¯Conditions</label><input id="conditions" class="form-control"></div>
      <div class="col-md-12"><label>Notes</label><textarea id="notes" class="form-control" rows="2"></textarea></div>
    </div>
    <h5 class="mt-4">Vitalsâ€¯(fromâ€¯ESP8266)</h5>
    <div class="row g-3">
      <div class="col-md-3"><label>Heartâ€¯Rateâ€¯(BPM)</label><input id="heart" class="form-control" readonly></div>
      <div class="col-md-3"><label>Oâ‚‚â€¯(%)</label><input id="o2" class="form-control" readonly></div>
      <div class="col-md-3"><label>Movement</label><input id="moves" class="form-control" readonly></div>
      <div class="col-md-3"><label>Temperatureâ€¯(Â°C)</label><input id="temp" class="form-control" readonly></div>
    </div>
    <button class="btn btn-success mt-3 px-4" onclick="saveProfile()">Saveâ€¯Profile</button>
  </div>
</section>

<!-- ==== TRACK ==== -->
<section id="track" class="section">
  <div class="card-box">
    <h3>Trackâ€¯Yourâ€¯Cycle</h3><hr>
    <div class="row g-3">
      <div class="col-md-6"><label>Startâ€¯Date</label><input type="date" id="startDate" class="form-control"></div>
      <div class="col-md-6"><label>Endâ€¯Date</label><input type="date" id="endDate" class="form-control"></div>
    </div>
    <h5 class="mt-4">Symptoms</h5>
    <div class="row g-3">
      <div class="col-md-4"><label>Flowâ€¯Level</label>
        <select id="flow" class="form-select"><option>Light</option><option>Moderate</option><option>Heavy</option></select>
      </div>
      <div class="col-md-4"><label>Painâ€¯Level</label><input type="range" id="pain" min="0" max="10" class="form-range"></div>
      <div class="col-md-4"><label>Periodâ€¯Colour</label>
        <input type="color" id="periodColor" class="form-control form-control-color" value="#ff8fa3">
      </div>
    </div>
    <button class="btn btn-primary mt-3 px-4" onclick="saveSymptoms()">Saveâ€¯&â€¯Predict</button>
    <h5 class="mt-4">Predictions</h5>
    <div class="row g-3">
      <div class="col-md-4"><label>Nextâ€¯Period</label><input class="form-control" id="nextPeriod" readonly></div>
      <div class="col-md-4"><label>Ovulation</label><input class="form-control" id="ovulation" readonly></div>
      <div class="col-md-4"><label>Fertileâ€¯Window</label><input class="form-control" id="fertile" readonly></div>
    </div>
  </div>
</section>

<!-- ==== LEARN ==== -->
<section id="learn" class="section">
  <div class="card-box">
    <h3>Learnâ€¯&â€¯Ask</h3>
    <p class="text-muted">Ask menstrual health, symptom, or diet questions forâ€¯AIâ€¯guidance.</p>
    <div class="mb-3"><label class="fw-semibold">Yourâ€¯question:</label>
      <input id="question" class="form-control" placeholder="e.g.â€¯What foods help reduce cramps?">
    </div>
    <button class="btn btn-primary mb-3" onclick="askQuestion()">Ask</button>
    <div><label class="fw-semibold">Answer:</label>
      <textarea id="answer" class="form-control" rows="5" readonly placeholder="Your answer will appear here..."></textarea>
    </div>
    <button id="listenBtn" class="btn mt-3" onclick="speakAnswer()">ðŸ”Šâ€¯Listenâ€¯toâ€¯answer</button>
  </div>
</section>

<!-- ==== RECORDS ==== -->
<section id="records" class="section">
  <div class="card-box">
    <h3>Recordsâ€¯History</h3>
    <p class="text-muted">Allâ€¯savedâ€¯Profileâ€¯andâ€¯Cycleâ€¯entries.</p>
    <div style="max-height:450px;overflow-y:auto;border:1px solid #e5d1f7;border-radius:10px;">
      <table class="table table-striped align-middle mb-0">
        <thead style="background:#f4e7fb;position:sticky;top:0;">
          <tr><th>Timestamp</th><th>Category</th><th>Data</th></tr>
        </thead>
        <tbody id="recordsTableBody"><tr><td colspan="3" class="text-center text-muted">No records yet</td></tr></tbody>
      </table>
    </div>
  </div>
</section>

</div></div>

<script>
function showScreen(id){document.querySelectorAll(".screen").forEach(s=>s.classList.remove("active"));document.getElementById(id).classList.add("active");}
function registerUser(){const e=signEmail.value.trim(),p=signPass.value,c=signConf.value;if(!e||!p){alert("Fill all fields");return;}if(p!==c){alert("Passwords donâ€™t match");return;}localStorage.setItem("userEmail",e);localStorage.setItem("userPass",p);alert("Signâ€‘up successful!");showScreen("screen2");}
function loginUser(){const e=loginEmail.value.trim(),p=loginPass.value,se=localStorage.getItem("userEmail"),sp=localStorage.getItem("userPass");if(e===se&&p===sp){alert("Login successful!");localStorage.setItem("currentUser",e);const hasData=localStorage.getItem(e+"_name")||localStorage.getItem(e+"_records");if(!hasData)resetAllData();showScreen("home");loadUserData(e);}else alert("Invalid credentials.");}
function logout(){alert("Logged out successfully!");showScreen("screen2");localStorage.removeItem("currentUser");}
function showSection(id){document.querySelectorAll(".section").forEach(s=>s.classList.remove("active-section"));document.getElementById(id).classList.add("active-section");}
function saveProfile(){const email=localStorage.getItem("currentUser");if(!email)return alert("Login first.");const prefix=email+"_";["name","age","gender","cycleLen","allergies","conditions","notes"].forEach(id=>localStorage.setItem(prefix+id,document.getElementById(id).value));alert("Profile saved!");addRecord("profile",{Name:name.value,Age:age.value,Gender:gender.value,Cycle_Length:cycleLen.value,Allergies:allergies.value,Conditions:conditions.value,Notes:notes.value});}
function saveSymptoms(){const email=localStorage.getItem("currentUser");if(!email){alert("Login first.");return;}const prefix=email+"_",start=startDate.value;if(!start)return alert("Select Start Date");const sd=new Date(start),addDays=d=>new Date(sd.getTime()+d*86400000).toLocaleDateString();nextPeriod.value=addDays(28);ovulation.value=addDays(14);fertile.value=`${addDays(10)} to ${addDays(15)}`;["startDate","endDate","flow","pain","periodColor"].forEach(id=>localStorage.setItem(prefix+id,document.getElementById(id).value));alert("Symptoms saved!");addRecord("track",{Name:name.value||localStorage.getItem(prefix+"name")||"(no name)",Start_Date:startDate.value,End_Date:endDate.value,Flow:flow.value,Pain_Level:pain.value,Period_Colour:periodColor.value,Next_Period:nextPeriod.value,Ovulation:ovulation.value,Fertile_Window:fertile.value});}
function addRecord(type,data){const email=localStorage.getItem("currentUser");if(!email)return;const prefix=email+"_",records=JSON.parse(localStorage.getItem(prefix+"records")||"[]");records.push({type,data,time:new Date().toLocaleString()});localStorage.setItem(prefix+"records",JSON.stringify(records));loadRecords(email);}
function loadRecords(email){const tbody=document.getElementById("recordsTableBody");if(!tbody)return;const prefix=email+"_",records=JSON.parse(localStorage.getItem(prefix+"records")||"[]").reverse();if(!records.length)return tbody.innerHTML=`<tr><td colspan='3' class='text-center text-muted'>No records yet</td></tr>`;tbody.innerHTML=records.map(r=>{const body=Object.entries(r.data).map(([k,v])=>k==="Period_Colour"?`<div><strong>${k}</strong>: <span style="display:inline-block;width:18px;height:18px;background:${v};border:1px solid #ccc;margin-left:5px;"></span></div>`:`<div><strong>${k}</strong>: ${v||"-"}</div>`).join("");return `<tr><td>${r.time}</td><td>${r.type==="track"?"Cycle Tracking":"Profile"}</td><td>${body}</td></tr>`;}).join("");}
async function askQuestion(){const q=question.value.trim();if(!q)return alert("Enter a question.");answer.value="Thinking...";const HF_TOKEN="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";const model="google/flan-t5-base";try{const res=await fetch(`https://api-inference.huggingface.co/models/${model}`,{method:"POST",headers:{"Authorization":`Bearer ${HF_TOKEN}`,"Content-Type":"application/json"},body:JSON.stringify({inputs:q})});const data=await res.json();answer.value=data?.[0]?.generated_text||data?.generated_text||"Sorry, I couldn't find an answer right now.";}catch(err){console.error(err);answer.value="Error contacting Hugging Face API.";}}
function speakAnswer(){const t=answer.value;if(!t)return alert("No answer to read.");const u=new SpeechSynthesisUtterance(t);u.rate=1;u.pitch=1;speechSynthesis.speak(u);}
function resetAllData(){["name","age","gender","cycleLen","allergies","conditions","notes","startDate","endDate","flow","pain","periodColor","nextPeriod","ovulation","fertile","question","answer"].forEach(id=>{const el=document.getElementById(id);if(el){if(el.tagName==="SELECT")el.selectedIndex=0;else if(el.type==="color")el.value="#ff8fa3";else el.value="";}});["heart","o2","moves","temp"].forEach(id=>{const e=document.getElementById(id);if(e)e.value="";});document.getElementById("recordsTableBody").innerHTML=`<tr><td colspan="3" class='text-center text-muted'>No records yet</td></tr>`;}
function loadUserData(email){const prefix=email+"_";["name","age","gender","cycleLen","allergies","conditions","notes"].forEach(id=>document.getElementById(id).value="");document.getElementById("periodColor").value="#ff8fa3";["name","age","gender","cycleLen","allergies","conditions","notes"].forEach(id=>{const v=localStorage.getItem(prefix+id);if(v)document.getElementById(id).value=v;});const pc=localStorage.getItem(prefix+"periodColor");if(pc)document.getElementById("periodColor").value=pc;loadRecords(email);}
</script>
</body>
</html>
